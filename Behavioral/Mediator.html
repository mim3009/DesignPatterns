<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
<script type="text/javascript">
	class Participant {
		constructor(name) {
			this.name = name;
			this.chatroom = null;
		}

		send(message, to) {
			this.chatroom.send(message, this, to);
		}
		
		receive(message, from) {
			console.log(from.name + " to " + this.name + ": " + message);
		}
	};

	function Chatroom() {
		let participants = {};

		return {
			register: function(participant) {
				participants[participant.name] = participant;
				participant.chatroom = this;
			},

			send: function(message, from, to) {
				if (to) {
					to.receive(message, from);
				}
				else {
					for (key in participants) {
						if (participants[key] !== from) {
							participants[key].receive(message, from);
						}
					}
				}
			}
		};
	};

	const yoko = new Participant("Yoko"),
		john = new Participant("John"),
		paul = new Participant("Paul"),
		ringo = new Participant("Ringo"),
		chatroom = new Chatroom();
	
	chatroom.register(yoko);
	chatroom.register(john);
	chatroom.register(paul);
	chatroom.register(ringo);

	yoko.send("All you need is love.");
	yoko.send("I love you John.");
	john.send("Hey, no need to broadcast", yoko);
	paul.send("Ha, I heard that!");
	ringo.send("Paul, what do you think?", paul);
</script>
</body>
</html>